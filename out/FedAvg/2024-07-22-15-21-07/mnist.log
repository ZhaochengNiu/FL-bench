==================== FedAvg ====================                                                                        
Experiment Arguments:                                                                                                   
{                                                                                                                       
  "mode": "serial",                                                                                                     
  "common": {                                                                                                           
    "dataset": "mnist",                                                                                                 
    "seed": 42,                                                                                                         
    "model": "lenet5",                                                                                                  
    "join_ratio": 0.1,                                                                                                  
    "global_epoch": 100,                                                                                                
    "local_epoch": 5,                                                                                                   
    "finetune_epoch": 0,                                                                                                
    "batch_size": 32,                                                                                                   
    "test_interval": 100,                                                                                               
    "straggler_ratio": 0,                                                                                               
    "straggler_min_local_epoch": 0,                                                                                     
    "external_model_params_file": null,                                                                                 
    "buffers": "local",                                                                                                 
    "optimizer": {                                                                                                      
      "lr": 0.01,                                                                                                       
      "dampening": 0,                                                                                                   
      "weight_decay": 0,                                                                                                
      "momentum": 0,                                                                                                    
      "nesterov": false,                                                                                                
      "name": "sgd"                                                                                                     
    },                                                                                                                  
    "eval_test": true,                                                                                                  
    "eval_val": false,                                                                                                  
    "eval_train": false,                                                                                                
    "verbose_gap": 10,                                                                                                  
    "visible": false,                                                                                                   
    "use_cuda": true,                                                                                                   
    "save_log": true,                                                                                                   
    "save_model": false,                                                                                                
    "save_fig": true,                                                                                                   
    "save_metrics": true,                                                                                               
    "delete_useless_run": true                                                                                          
  },                                                                                                                    
  "parallel": {                                                                                                         
    "ray_cluster_addr": null,                                                                                           
    "num_gpus": null,                                                                                                   
    "num_cpus": null,                                                                                                   
    "num_workers": 2                                                                                                    
  },                                                                                                                    
  "dataset": {                                                                                                          
    "client_num": 100,                                                                                                  
    "test_ratio": 0.2,                                                                                                  
    "val_ratio": 0.2,                                                                                                   
    "seed": 42,                                                                                                         
    "split": "sample",                                                                                                  
    "IID_ratio": 0.0,                                                                                                   
    "monitor_window_name_suffix": "mnist-100clients-0%IID-Dir(0.1)-seed42",                                             
    "alpha": 0.1,                                                                                                       
    "least_samples": 40                                                                                                 
  }                                                                                                                     
}                                                                                                                       
---------------------------- TRAINING EPOCH: 10 ----------------------------                                            
client [77] (testset)   loss: 0.5893 -> 0.0024  accuracy: 89.80% -> 100.00%                                             
client [81] (testset)   loss: 1.4587 -> 0.0407  accuracy: 61.54% -> 100.00%                                             
client [21] (testset)   loss: 1.6538 -> 0.0039  accuracy: 93.18% -> 100.00%                                             
client [68] (testset)   loss: 2.2328 -> 0.4133  accuracy: 13.11% -> 90.16%                                              
client [93] (testset)   loss: 0.4447 -> 0.1160  accuracy: 95.90% -> 97.54%                                              
client [31] (testset)   loss: 1.0486 -> 0.2138  accuracy: 75.86% -> 91.95%                                              
client [20] (testset)   loss: 2.4922 -> 0.0868  accuracy: 10.71% -> 100.00%                                             
client [59] (testset)   loss: 15.8536 -> 0.0743 accuracy: 61.35% -> 99.39%                                              
client [48] (testset)   loss: 1.0596 -> 0.2646  accuracy: 61.17% -> 92.23%                                              
client [34] (testset)   loss: 1.5369 -> 0.0392  accuracy: 56.79% -> 100.00%                                             
---------------------------- TRAINING EPOCH: 20 ----------------------------                                            
client [69] (testset)   loss: 0.4152 -> 0.0330  accuracy: 82.52% -> 99.30%                                              
client [99] (testset)   loss: 0.3844 -> 0.0076  accuracy: 87.13% -> 100.00%                                             
client [67] (testset)   loss: 1.1714 -> 0.2101  accuracy: 60.00% -> 93.33%                                              
client [0]  (testset)   loss: 1.9170 -> 0.0093  accuracy: 6.18% -> 99.64%                                               
client [76] (testset)   loss: 0.1354 -> 0.0218  accuracy: 100.00% -> 100.00%                                            
client [41] (testset)   loss: 0.6481 -> 0.0589  accuracy: 78.11% -> 98.22%                                              
client [62] (testset)   loss: 28.8486 -> 0.1596 accuracy: 71.83% -> 97.89%                                              
client [2]  (testset)   loss: 6.5874 -> 0.0353  accuracy: 92.23% -> 99.03%                                              
client [14] (testset)   loss: 1.1079 -> 0.1425  accuracy: 60.82% -> 93.81%                                              
client [46] (testset)   loss: 0.5787 -> 0.0519  accuracy: 76.81% -> 99.28%                                              
---------------------------- TRAINING EPOCH: 30 ----------------------------                                            
client [24] (testset)   loss: 0.1438 -> 0.0432  accuracy: 100.00% -> 100.00%                                            
client [68] (testset)   loss: 1.2853 -> 0.0966  accuracy: 45.90% -> 96.72%                                              
client [57] (testset)   loss: 0.2650 -> 0.0132  accuracy: 93.05% -> 99.23%                                              
client [17] (testset)   loss: 0.0209 -> 0.0024  accuracy: 100.00% -> 100.00%                                            
client [54] (testset)   loss: 1.6435 -> 0.0827  accuracy: 45.45% -> 98.18%                                              
client [23] (testset)   loss: 32.3779 -> 0.1063 accuracy: 72.00% -> 100.00%                                             
client [35] (testset)   loss: 0.4309 -> 0.0574  accuracy: 85.87% -> 98.91%                                              
client [59] (testset)   loss: 0.1429 -> 0.0112  accuracy: 97.55% -> 100.00%                                             
client [31] (testset)   loss: 0.3606 -> 0.0612  accuracy: 91.95% -> 97.70%                                              
client [9]  (testset)   loss: 1.3612 -> 0.0725  accuracy: 41.67% -> 98.44%                                              
---------------------------- TRAINING EPOCH: 40 ----------------------------                                            
client [64] (testset)   loss: 0.1943 -> 0.0012  accuracy: 93.87% -> 100.00%                                             
client [33] (testset)   loss: 0.6394 -> 0.0172  accuracy: 77.59% -> 100.00%                                             
client [16] (testset)   loss: 0.4902 -> 0.0343  accuracy: 80.14% -> 98.63%                                              
client [44] (testset)   loss: 1.0770 -> 0.0009  accuracy: 76.05% -> 100.00%                                             
client [8]  (testset)   loss: 0.9513 -> 0.0628  accuracy: 69.72% -> 97.89%                                              
client [31] (testset)   loss: 0.4395 -> 0.0433  accuracy: 86.21% -> 98.85%                                              
client [47] (testset)   loss: 0.0499 -> 0.0009  accuracy: 100.00% -> 100.00%                                            
client [36] (testset)   loss: 0.4133 -> 0.0292  accuracy: 100.00% -> 100.00%                                            
client [20] (testset)   loss: 0.1795 -> 0.0293  accuracy: 92.86% -> 100.00%                                             
client [56] (testset)   loss: 0.2503 -> 0.0043  accuracy: 92.00% -> 100.00%                                             
---------------------------- TRAINING EPOCH: 50 ----------------------------                                            
client [4]  (testset)   loss: 0.2877 -> 0.0034  accuracy: 92.02% -> 100.00%                                             
client [60] (testset)   loss: 1.0876 -> 0.0001  accuracy: 68.32% -> 100.00%                                             
client [28] (testset)   loss: 0.1705 -> 0.2045  accuracy: 93.94% -> 93.94%                                              
client [25] (testset)   loss: 0.2122 -> 0.0466  accuracy: 93.52% -> 97.69%                                              
client [58] (testset)   loss: 0.3534 -> 0.0495  accuracy: 86.62% -> 98.59%                                              
client [44] (testset)   loss: 0.2408 -> 0.0008  accuracy: 92.86% -> 100.00%                                             
client [39] (testset)   loss: 0.5719 -> 0.0512  accuracy: 81.11% -> 97.78%                                              
client [29] (testset)   loss: 0.2419 -> 0.0055  accuracy: 93.33% -> 100.00%                                             
client [3]  (testset)   loss: 0.2323 -> 0.0171  accuracy: 93.75% -> 99.31%                                              
client [84] (testset)   loss: 0.1466 -> 0.0003  accuracy: 96.24% -> 100.00%                                             
---------------------------- TRAINING EPOCH: 60 ----------------------------                                            
client [21] (testset)   loss: 0.5231 -> 0.0002  accuracy: 79.87% -> 100.00%                                             
client [84] (testset)   loss: 0.0212 -> 0.0004  accuracy: 99.46% -> 100.00%                                             
client [10] (testset)   loss: 2.2179 -> 0.3210  accuracy: 23.33% -> 90.00%                                              
client [36] (testset)   loss: 0.1453 -> 0.0281  accuracy: 100.00% -> 100.00%                                            
client [65] (testset)   loss: 0.4800 -> 0.0684  accuracy: 90.00% -> 97.14%                                              
client [81] (testset)   loss: 4.1868 -> 0.0006  accuracy: 7.69% -> 100.00%                                              
client [79] (testset)   loss: 0.9749 -> 0.0308  accuracy: 57.50% -> 98.12%                                              
client [42] (testset)   loss: 0.4002 -> 0.1112  accuracy: 91.18% -> 94.12%                                              
client [11] (testset)   loss: 1.0491 -> 0.0663  accuracy: 64.43% -> 97.99%                                              
client [96] (testset)   loss: 0.8723 -> 0.0670  accuracy: 69.06% -> 97.84%                                              
---------------------------- TRAINING EPOCH: 70 ----------------------------                                            
client [8]  (testset)   loss: 0.8833 -> 0.0435  accuracy: 73.94% -> 98.59%                                              
client [53] (testset)   loss: 0.3379 -> 0.0471  accuracy: 85.54% -> 98.80%                                              
client [52] (testset)   loss: 0.0275 -> 0.0243  accuracy: 100.00% -> 100.00%                                            
client [42] (testset)   loss: 0.2312 -> 0.0612  accuracy: 88.24% -> 100.00%                                             
client [69] (testset)   loss: 0.1857 -> 0.0071  accuracy: 93.71% -> 100.00%                                             
client [59] (testset)   loss: 0.4656 -> 0.0025  accuracy: 84.05% -> 100.00%                                             
client [7]  (testset)   loss: 1.4434 -> 0.0152  accuracy: 56.60% -> 99.65%                                              
client [26] (testset)   loss: 0.0913 -> 0.0460  accuracy: 97.01% -> 99.40%                                              
client [49] (testset)   loss: 0.7441 -> 0.0311  accuracy: 79.02% -> 99.30%                                              
client [98] (testset)   loss: 0.2756 -> 0.0942  accuracy: 84.62% -> 100.00%                                             
---------------------------- TRAINING EPOCH: 80 ----------------------------                                            
client [98] (testset)   loss: 0.1890 -> 0.0502  accuracy: 84.62% -> 100.00%                                             
client [47] (testset)   loss: 0.0348 -> 0.0003  accuracy: 100.00% -> 100.00%                                            
client [21] (testset)   loss: 0.3284 -> 0.0002  accuracy: 88.31% -> 100.00%                                             
client [77] (testset)   loss: 0.1975 -> 0.0029  accuracy: 95.24% -> 100.00%                                             
client [95] (testset)   loss: 0.1359 -> 0.0124  accuracy: 97.91% -> 99.58%                                              
client [91] (testset)   loss: 0.1372 -> 0.0512  accuracy: 93.62% -> 97.87%                                              
client [14] (testset)   loss: 0.1116 -> 0.0273  accuracy: 97.94% -> 100.00%                                             
client [99] (testset)   loss: 0.1137 -> 0.0007  accuracy: 97.03% -> 100.00%                                             
client [20] (testset)   loss: 0.7661 -> 0.0195  accuracy: 75.00% -> 100.00%                                             
client [39] (testset)   loss: 1.5015 -> 0.0421  accuracy: 63.33% -> 98.89%                                              
---------------------------- TRAINING EPOCH: 90 ----------------------------                                            
client [52] (testset)   loss: 0.4025 -> 0.0792  accuracy: 93.33% -> 96.67%                                              
client [62] (testset)   loss: 0.2854 -> 0.1622  accuracy: 93.66% -> 98.59%                                              
client [71] (testset)   loss: 0.1402 -> 0.0687  accuracy: 95.90% -> 97.79%                                              
client [97] (testset)   loss: 0.2771 -> 0.0030  accuracy: 92.62% -> 100.00%                                             
client [30] (testset)   loss: 0.0934 -> 0.0120  accuracy: 96.00% -> 100.00%                                             
client [88] (testset)   loss: 0.3004 -> 0.0782  accuracy: 91.10% -> 97.95%                                              
client [60] (testset)   loss: 1.9958 -> 0.0000  accuracy: 33.17% -> 100.00%                                             
client [82] (testset)   loss: 0.2281 -> 0.0171  accuracy: 92.50% -> 100.00%                                             
client [91] (testset)   loss: 0.2421 -> 0.0477  accuracy: 89.36% -> 97.87%                                              
client [57] (testset)   loss: 0.7037 -> 0.0042  accuracy: 75.68% -> 100.00%                                             
---------------------------- TRAINING EPOCH: 100 ----------------------------                                           
client [31] (testset)   loss: 0.1528 -> 0.0175  accuracy: 93.10% -> 100.00%                                             
client [15] (testset)   loss: 0.0689 -> 0.0112  accuracy: 100.00% -> 100.00%                                            
client [71] (testset)   loss: 0.1530 -> 0.0672  accuracy: 95.27% -> 98.11%                                              
client [97] (testset)   loss: 0.1640 -> 0.0052  accuracy: 95.97% -> 100.00%                                             
client [53] (testset)   loss: 0.1804 -> 0.0551  accuracy: 89.16% -> 97.59%                                              
client [77] (testset)   loss: 0.0627 -> 0.0024  accuracy: 97.28% -> 100.00%                                             
client [76] (testset)   loss: 0.0385 -> 0.0027  accuracy: 100.00% -> 100.00%                                            
client [79] (testset)   loss: 0.3669 -> 0.0356  accuracy: 86.88% -> 98.12%                                              
client [28] (testset)   loss: 0.0713 -> 0.1493  accuracy: 96.97% -> 93.94%                                              
client [99] (testset)   loss: 0.1163 -> 0.0009  accuracy: 95.71% -> 100.00%                                             
FedAvg's average time taken by each global epoch: 0 min 3.17 sec.                                                       
FedAvg's total running time: 0 h 5 m 18 s.                                                                              
==================== FedAvg Experiment Results: ====================                                                    
Format: (before local fine-tuning) -> (after local fine-tuning)                                                         
 So if finetune_epoch = 0, x.xx% -> 0.00% is normal.                                                                    
{100: {'all_clients': {'test': {'loss': '0.3846 -> 0.0000', 'accuracy': '88.85% -> 0.00%'}}}}                           
========== FedAvg Convergence on train clients ==========                                                               
test (before local training):                                                                                           
10.0%(13.67%) at epoch: 1                                                                                               
20.0%(24.37%) at epoch: 3                                                                                               
50.0%(55.83%) at epoch: 7                                                                                               
70.0%(74.57%) at epoch: 9                                                                                               
80.0%(87.22%) at epoch: 18                                                                                              
90.0%(92.75%) at epoch: 37                                                                                              
test (after local training):                                                                                            
70.0%(78.74%) at epoch: 0                                                                                               
80.0%(88.69%) at epoch: 1                                                                                               
90.0%(91.53%) at epoch: 2                                                                                               
==================== FedAvg Max Accuracy ====================                                                           
all_clients:                                                                                                            
(test) before fine-tuning: 88.85% at epoch 100                                                                          
(test) after fine-tuning: 0.00% at epoch 100                                                                            
